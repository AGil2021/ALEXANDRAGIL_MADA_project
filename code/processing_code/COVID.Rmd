---
title: "COVID"
output: html_document
---
This section of the project is the exploratory data analysis (EDA). It will be save at processed_data as Rdm file, as COVID.

install.packages("dplyr")
install.packages("tidyverse")
#load needed packages.
```{r}
library(dplyr) #for data processing
library(here) #to set paths
library(tidyverse)
```

#Path to data
```{r}
data_location <- here::here("datacovid","raw_data","Provisional_COVID-19_Deaths_by_Sex_and_Age.csv")
rawdata <- read.csv(data_location)

col_types = cols(Year = col_factor(), 
Month = col_character(), 
Footnote = col_character())

```
# What is in my dataset?
```{r}
dplyr::glimpse(rawdata)
```
#Statistical Summary
```{r}
summary(rawdata)

table(rawdata$Year)
table(rawdata$State)
table(rawdata$Sex)
table(rawdata$`Age Group`)

unique(rawdata$State)
```
# Filter Data
#The maximum values are too large in comparison with the median that corresponds to 50% of the data, which generally oscillates around 0, for this reason, for a better visualization, a cut-off point was taken to filter the data
```{r}
newdata<- rawdata%>%
          filter(`COVID.19.Deaths`< 400)
newdata
glimpse(newdata)

```
#Plots and Tables
```{r}
bp <- ggplot(newdata, aes( x = `COVID.19.Deaths`)) + geom_histogram()

bp

histo <- ggplot(newdata, aes( x = `COVID.19.Deaths`)) + geom_histogram()+
        facet_grid(Sex ~ .)
histo

bp1 <- ggplot(newdata, aes(x=`Pneumonia.Deaths`)) + geom_histogram()

bp1

bp2 <- ggplot(newdata, aes(x=`Influenza.Deaths` ))+ geom_histogram()

bp2

bp3 <- ggplot(newdata, aes(x=`Pneumonia.and.COVID.19.Deaths`))+ geom_histogram()

bp3

```
#Model
```{r}
fit <- lm(`COVID.19.Deaths`~ Sex+`Age.Group`+State + Year , data=newdata )

summary(fit)

layout(matrix(c(1,2,3,4),2,2))  

plot(fit)

```
#Since the values of Covid-19 deaths,Pneumonia Deaths, and Influenza Deaths are close to zero, is necessary orienting the study by age and sex.

#Save GA data 
```{r}
# The data will be saved as rds

# Data location 
save_data_location <- here::here("code", "processing_code","Covid-Deaths.rds")

saveRDS(GA, file = save_data_location )
```


